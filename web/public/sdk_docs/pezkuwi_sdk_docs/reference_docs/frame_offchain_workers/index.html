<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Learn about the offchain workers, how they function, and how to use them, as provided by the `frame` APIs."><title>pezkuwi_sdk_docs::reference_docs::frame_offchain_workers - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="pezkuwi_sdk_docs" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="icon" href="https://pezkuwichain.io/favicon.ico"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module frame_offchain_workers</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../pezkuwi_sdk_docs/index.html">pezkuwi_<wbr>sdk_<wbr>docs</a><span class="version">0.0.1</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module frame_<wbr>offchain_<wbr>workers</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#offchain-workers" title="Offchain Workers">Offchain Workers</a><ul><li><a href="#context" title="Context">Context</a></li><li><a href="#nondeterministic-execution" title="Nondeterministic Execution">Nondeterministic Execution</a></li><li><a href="#frames-api" title="FRAME’s API">FRAME’s API</a></li><li><a href="#think-twice-why-use-substrates-offchain-workers" title="Think Twice: Why Use Substrate’s Offchain Workers?">Think Twice: Why Use Substrate’s Offchain Workers?</a></li><li><a href="#further-references" title="Further References">Further References</a></li></ul></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In pezkuwi_<wbr>sdk_<wbr>docs::<wbr>reference_<wbr>docs</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">pezkuwi_sdk_docs</a>::<wbr><a href="../index.html">reference_docs</a></div><h1>Module <span>frame_<wbr>offchain_<wbr>workers</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/pezkuwi_sdk_docs/reference_docs/frame_offchain_workers.rs.html#1-114">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Learn about the offchain workers, how they function, and how to use them, as provided by the
[<code>frame</code>] APIs.</p>
<h2 id="offchain-workers"><a class="doc-anchor" href="#offchain-workers">§</a>Offchain Workers</h2>
<p>This reference document explains how offchain workers work in Substrate and FRAME. The main
focus is upon FRAME’s implementation of this functionality. Nonetheless, offchain workers are a
Substrate-provided feature and can be used with possible alternatives to [<code>frame</code>] as well.</p>
<p>Offchain workers are a commonly misunderstood topic, therefore we explain them bottom-up,
starting at the fundamentals and then describing the developer interface.</p>
<h3 id="context"><a class="doc-anchor" href="#context">§</a>Context</h3>
<p>Recall from <a href="../wasm_meta_protocol/index.html" title="mod pezkuwi_sdk_docs::reference_docs::wasm_meta_protocol"><code>crate::reference_docs::wasm_meta_protocol</code></a> that the node and the runtime
communicate with one another via host functions and runtime APIs. Many of these interactions
contribute to the actual state transition of the blockchain. For example [<code>sp_api::Core</code>] is the
main runtime API that is called to execute new blocks.</p>
<p>Offchain workers are in principle not different in any way: It is a runtime API exposed by the
wasm blob ([<code>sp_offchain::OffchainWorkerApi</code>]), and the node software calls into it when it
deems fit. But, crucially, this API call is different in that:</p>
<ol>
<li>It can have no impact on the state ie. it is <em>OFF (the) CHAIN</em>. If any state is altered
during the execution of this API call, it is discarded.</li>
<li>It has access to an extended set of host functions that allow the wasm blob to do more. For
example, call into HTTP requests.</li>
</ol>
<blockquote>
<p>The main way through which an offchain worker can interact with the state is by submitting an
extrinsic to the chain. This is the ONLY way to alter the state from an offchain worker.
[<code>pallet_example_offchain_worker</code>] provides an example of this.</p>
</blockquote>
<p>Given the “Off Chain” nature of this API, it is important to remember that calling this API is
entirely optional. Some nodes might call into it, some might not, and it would have no impact on
the execution of your blockchain because no state is altered no matter the execution of the
offchain worker API.</p>
<p>Substrate’s CLI allows some degree of configuration about this, allowing node operators to
specify when they want to run the offchain worker API. See
[<code>sc_cli::RunCmd::offchain_worker_params</code>].</p>
<h3 id="nondeterministic-execution"><a class="doc-anchor" href="#nondeterministic-execution">§</a>Nondeterministic Execution</h3>
<p>Needless to say, given the above description, the code in your offchain worker API can be
nondeterministic, as it is not part of the blockchain’s STF, so it can be executed at unknown
times, by unknown nodes, and has no impact on the state. This is why an HTTP
([<code>sp_runtime::offchain::http</code>]) API is readily provided to the offchain worker APIs. Because
there is no need for determinism in this context.</p>
<blockquote>
<p>A common mistake here is for novice developers to see this HTTP API, and imagine that
<code>pezkuwi-sdk</code> somehow magically solved the determinism in blockchains, and now a blockchain
can make HTTP calls and it will all work. This is absolutely NOT the case. An HTTP call made
by the offchain worker is non-deterministic by design. Blockchains can’t and always won’t be
able to perform non-deterministic operations such as making HTTP calls to a foreign server.</p>
</blockquote>
<h3 id="frames-api"><a class="doc-anchor" href="#frames-api">§</a>FRAME’s API</h3>
<p>[<code>frame</code>] provides a simple API through which pallets can define offchain worker functions. This
is part of [<code>frame::traits::Hooks</code>], which is implemented as a part of
[<code>frame::pallet_macros::hooks</code>].</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#[frame::pallet]
</span><span class="kw">pub mod </span>pallet {
	<span class="kw">use </span>frame::prelude::<span class="kw-2">*</span>;

	<span class="attr">#[pallet::config]
	</span><span class="kw">pub trait </span>Config: frame_system::Config {}

	<span class="attr">#[pallet::pallet]
	</span><span class="kw">pub struct </span>Pallet&lt;T&gt;(<span class="kw">_</span>);

	<span class="attr">#[pallet::hooks]
	</span><span class="kw">impl</span>&lt;T: Config&gt; Hooks&lt;BlockNumberFor&lt;T&gt;&gt; <span class="kw">for </span>Pallet&lt;T&gt; {
		<span class="kw">fn </span>offchain_worker(block_number: BlockNumberFor&lt;T&gt;) {
			<span class="comment">// ...
		</span>}
	}
}</code></pre></div>
<p>Additionally, [<code>sp_runtime::offchain</code>] provides a set of utilities that can be used to moderate
the execution of offchain workers.</p>
<h3 id="think-twice-why-use-substrates-offchain-workers"><a class="doc-anchor" href="#think-twice-why-use-substrates-offchain-workers">§</a>Think Twice: Why Use Substrate’s Offchain Workers?</h3>
<p>Consider the fact that in principle, an offchain worker code written using the above API is no
different than an equivalent written with an <em>actual offchain interaction library</em>, such as
<a href="https://pezkuwi.js.org/docs/">Pezkuwi-JS</a>, or any of the other ones listed <a href="https://github.com/substrate-developer-hub/awesome-substrate?tab=readme-ov-file#client-libraries">here</a>.</p>
<p>They can both read from the state, and have no means of updating the state, other than the route
of submitting an extrinsic to the chain. Therefore, it is worth thinking twice before embedding
a logic as a part of Substrate’s offchain worker API. Does it have to be there? Can it not be a
simple, actual offchain application that lives outside of the chain’s WASM blob?</p>
<p>Some of the reasons why you might want to do the opposite, and actually embed an offchain worker
API into the WASM blob are:</p>
<ul>
<li>Accessing the state is easier within the <code>offchain_worker</code> function, as it is already a part
of the runtime, and [<code>frame::pallet_macros::storage</code>] provides all the tools needed to read
the state. Other client libraries might provide varying degrees of capability here.</li>
<li>It will be updated in synchrony with the runtime. A Substrate’s offchain application is part
of the same WASM blob, and is therefore guaranteed to be up to date.</li>
</ul>
<p>For example, imagine you have modified a storage item to have a new type. This will possibly
require a <a href="../frame_runtime_upgrades_and_migrations/index.html" title="mod pezkuwi_sdk_docs::reference_docs::frame_runtime_upgrades_and_migrations"><code>crate::reference_docs::frame_runtime_upgrades_and_migrations</code></a>, and any offchain
code, such as a Pezkuwi-JS application, will have to be updated to reflect this change. Whereas
the WASM offchain worker code is guaranteed to already be updated, or else the runtime code will
not even compile.</p>
<h3 id="further-references"><a class="doc-anchor" href="#further-references">§</a>Further References</h3>
<ul>
<li><a href="https://forum.network.pezkuwichain.io/t/offchain-workers-design-assumptions-vulnerabilities/2548">https://forum.network.pezkuwichain.io/t/offchain-workers-design-assumptions-vulnerabilities/2548</a></li>
<li><a href="https://exchange.pezkuwichain.app/questions/11058/how-can-i-create-ocw-that-wont-activates-every-block-but-will-activates-only-w/11060#11060">https://exchange.pezkuwichain.app/questions/11058/how-can-i-create-ocw-that-wont-activates-every-block-but-will-activates-only-w/11060#11060</a></li>
<li><a href="https://github.com/pezkuwichain/pezkuwi-sdk/tree/master/substrate/frame/examples/offchain-worker">Offchain worker example</a></li>
</ul>
</div></details></section></div></main></body></html>